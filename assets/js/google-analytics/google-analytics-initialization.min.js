$(document).ready(function(){gapi.analytics.ready(function(){gapi.analytics.auth.authorize({serverAuth:{access_token:accessToken}});var d=new gapi.analytics.ext.ActiveUsers({container:"active-users-container",pollingInterval:5});d.once("success",function(){var k=this.container.firstChild;var l;this.on("change",function(n){var m=this.container.firstChild;var o=n.delta>0?"is-increasing":"is-decreasing";m.className+=(" "+o);clearTimeout(l);l=setTimeout(function(){m.className=m.className.replace(/ is-(increasing|decreasing)/g,"")},3000)})});var a=new gapi.analytics.ext.ViewSelector2({container:"view-selector-container",}).execute();a.on("viewChange",function(k){var l=document.getElementById("view-name");l.textContent=k.property.name+" ("+k.view.name+")";d.set(k).execute();j(k.ids);g(k.ids);b(k.ids);i(k.ids)});function i(k){var l=new gapi.analytics.googleCharts.DataChart({query:{metrics:"ga:sessions",dimensions:"ga:date","start-date":"30daysAgo","end-date":"yesterday"},chart:{container:"chart-1-container",type:"LINE",options:{width:"100%",colors:["#daa508"]}}}).set({query:{ids:k}}).execute()}function j(n){var l=moment();var k=h({ids:n,dimensions:"ga:date,ga:nthDay",metrics:"ga:sessions","start-date":moment(l).subtract(1,"day").day(0).format("YYYY-MM-DD"),"end-date":moment(l).format("YYYY-MM-DD")});var m=h({ids:n,dimensions:"ga:date,ga:nthDay",metrics:"ga:sessions","start-date":moment(l).subtract(1,"day").day(0).subtract(1,"week").format("YYYY-MM-DD"),"end-date":moment(l).subtract(1,"day").day(6).subtract(1,"week").format("YYYY-MM-DD")});Promise.all([k,m]).then(function(p){var o=p[0].rows.map(function(t){return +t[2]});var s=p[1].rows.map(function(t){return +t[2]});var r=p[1].rows.map(function(t){return +t[0]});r=r.map(function(t){return moment(t,"YYYYMMDD").format("ddd")});var q={labels:r,datasets:[{label:"Last Week",fillColor:"rgba(243,206,98,0.5)",strokeColor:"rgba(243,206,98,1)",pointColor:"rgba(243,206,98,1)",pointStrokeColor:"#fff",data:s},{label:"This Week",fillColor:"rgba(218,165,8,0.5)",strokeColor:"rgba(218,165,8,1)",pointColor:"rgba(218,165,8,1)",pointStrokeColor:"#fff",data:o}]};new Chart(e("chart-2-container")).Line(q);f("legend-2-container",q.datasets)})}function g(k){h({ids:k,dimensions:"ga:deviceCategory",metrics:"ga:pageviews",sort:"-ga:pageviews","max-results":3}).then(function(m){var n=[];var l=["#daa508","#ffc825","#ffdb6f"];m.rows.forEach(function(p,o){n.push({value:+p[1],color:l[o],label:p[0]})});new Chart(e("chart-3-container")).Doughnut(n);f("legend-3-container",n)})}function b(k){h({ids:k,dimensions:"ga:country",metrics:"ga:sessions",sort:"-ga:sessions","max-results":5}).then(function(m){var n=[];var l=["#daa508","#ffc825","#ffdb6f","#fde7a6","#fff4d2"];m.rows.forEach(function(p,o){n.push({label:p[0],value:+p[1],color:l[o]})});new Chart(e("chart-4-container")).Doughnut(n);f("legend-4-container",n)})}function h(k){return new Promise(function(n,m){var l=new gapi.analytics.report.Data({query:k});l.once("success",function(o){n(o)}).once("error",function(o){m(o)}).execute()})}function e(n){var l=document.getElementById(n);var m=document.createElement("canvas");var k=m.getContext("2d");l.innerHTML="";m.width=l.offsetWidth;m.height=l.offsetHeight;l.appendChild(m);return k}function f(m,k){var l=document.getElementById(m);l.innerHTML=k.map(function(p){var n=p.color||p.fillColor;var o=p.label;return'<li><i style="background:'+n+'"></i>'+c(o)+"</li>"}).join("")}Chart.defaults.global.animationSteps=60;Chart.defaults.global.animationEasing="easeInOutQuart";Chart.defaults.global.responsive=true;Chart.defaults.global.maintainAspectRatio=false;function c(k){var l=document.createElement("div");l.appendChild(document.createTextNode(k));return l.innerHTML}})});